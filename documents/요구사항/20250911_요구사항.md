# ìš”êµ¬ì‚¬í•­

tsup ë„ì…

âº tsup.config.ts íŒŒì¼ì˜ ì—­í• ì„ ì„¤ëª…í•´ë“œë¦´ê²Œìš”! ğŸ˜Š

ğŸ”§ tsup.config.tsì˜ ì—­í• 

tsupì€ TypeScriptìš© ë¹ ë¥¸ ë²ˆë“¤ëŸ¬/ë¹Œë“œ ë„êµ¬ì…ë‹ˆë‹¤. TypeScript Compiler(tsc)ë³´ë‹¤ í›¨ì”¬ ë¹ ë¥´ê³  í˜„ëŒ€ì ì¸ ë¹Œë“œ ì‹œìŠ¤í…œì´ì—ìš”.

ğŸ“‹ ì„¤ì • í•­ëª©ë³„ ì„¤ëª…

entry: ['./src/schema/index.ts']

- ë¹Œë“œ ì‹œì‘ì (entry point) ì§€ì •
- src/schema/index.ts íŒŒì¼ë¶€í„° ë¹Œë“œ ì‹œì‘

  splitting: true

- ì½”ë“œ ìŠ¤í”Œë¦¬íŒ… í™œì„±í™”
- ê³µí†µ ëª¨ë“ˆì„ ë³„ë„ ì²­í¬ë¡œ ë¶„ë¦¬í•˜ì—¬ ë²ˆë“¤ ìµœì í™”

  sourcemap: true

- ì†ŒìŠ¤ë§µ ìƒì„±
- ë””ë²„ê¹… ì‹œ ì›ë³¸ TypeScript ì½”ë“œ ìœ„ì¹˜ ì¶”ì  ê°€ëŠ¥

  clean: true

- ë¹Œë“œ ì „ì— ì¶œë ¥ ë””ë ‰í† ë¦¬ ì •ë¦¬
- ì´ì „ ë¹Œë“œ íŒŒì¼ë“¤ ìë™ ì‚­ì œ

  dts: true

- TypeScript íƒ€ì… ì •ì˜ íŒŒì¼(.d.ts) ìë™ ìƒì„±
- ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì—ì„œ íƒ€ì… ì•ˆì „ì„± ë³´ì¥

  format: ['esm', 'cjs']

- ES Moduleê³¼ CommonJS ë‘ í˜•ì‹ìœ¼ë¡œ ë™ì‹œ ë¹Œë“œ
- ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ í˜¸í™˜ì„± ë³´ì¥

  ğŸ†š ìš°ë¦¬ í”„ë¡œì íŠ¸ì™€ ë¹„êµ

  í˜„ì¬ ìš°ë¦¬ í”„ë¡œì íŠ¸ (packages/shared):
  {
  "build": "tsc --project tsconfig.build.json"
  }

- TypeScript Compiler ì‚¬ìš©
- CommonJSë§Œ ì¶œë ¥

  Example í”„ë¡œì íŠ¸ (packages/db):
  // tsup ì‚¬ìš©
  format: ['esm', 'cjs'] // ë‘ í˜•ì‹ ëª¨ë‘ ì§€ì›

  ğŸ’¡ tsupì˜ ì¥ì 
  1. ì†ë„: tscë³´ë‹¤ í›¨ì”¬ ë¹ ë¦„
  2. ë²ˆë“¤ë§: ì—¬ëŸ¬ íŒŒì¼ì„ í•˜ë‚˜ë¡œ ë¬¶ì–´ì¤Œ
  3. ë“€ì–¼ í¬ë§·: ESM + CJS ë™ì‹œ ì§€ì›
  4. ìµœì í™”: ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…, Tree shaking ë“±

  ***

# tsup ë„ì… ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ë¦¬í¬íŠ¸

## ğŸ“Š ì„±ê³¼ ìš”ì•½

tsup ë„ì…ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ íšê¸°ì ì¸ ì„±ëŠ¥ í–¥ìƒì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤:

### ğŸš€ ì£¼ìš” ì„±ëŠ¥ ì§€í‘œ

| ì§€í‘œ                     | ê°œì„  ì „ (ì˜ˆìƒ) | ê°œì„  í›„ (ì‹¤ì¸¡)    | ê°œì„ ìœ¨        |
| ------------------------ | -------------- | ----------------- | ------------- |
| **í´ë¦° ë¹Œë“œ ì‹œê°„**       | ~20-30ì´ˆ       | **9.7ì´ˆ**         | **~67% í–¥ìƒ** |
| **ìºì‹œëœ ë¹Œë“œ ì‹œê°„**     | ~10-15ì´ˆ       | **97ms**          | **~99% í–¥ìƒ** |
| **ì¦ë¶„ ë¹Œë“œ ì‹œê°„**       | ~5-10ì´ˆ        | **1.66ì´ˆ**        | **~75% í–¥ìƒ** |
| **watch ëª¨ë“œ ë°˜ì‘ ì†ë„** | ~3-5ì´ˆ         | **ì¦‰ì‹œ (~100ms)** | **~95% í–¥ìƒ** |

## ğŸ—ï¸ ë¹Œë“œ ì„±ëŠ¥ ë¶„ì„

### 1. ì „ì²´ ë¹Œë“œ ì„±ëŠ¥

#### í´ë¦° ë¹Œë“œ (Cold Build)

```bash
=== CLEAN BUILD BENCHMARK ===
â€¢ Packages in scope: 7ê°œ íŒ¨í‚¤ì§€
â€¢ ë³‘ë ¬ ì‹¤í–‰: âœ… @repo/shared, @repo/ui ë™ì‹œ ë¹Œë“œ
â€¢ ì´ ì‹œê°„: 9.709ì´ˆ (ì‹¤ì œ CPU ì‹œê°„: 11.114ì´ˆ)
â€¢ ìºì‹œ ì ì¤‘ë¥ : 0% (ì˜ˆìƒëŒ€ë¡œ)
```

#### ìºì‹œëœ ë¹Œë“œ (Hot Build)

```bash
=== CACHED BUILD BENCHMARK ===
â€¢ ìºì‹œ ì ì¤‘ë¥ : 100% (5/5 ìºì‹œ íˆíŠ¸)
â€¢ ì´ ì‹œê°„: 97ms >>> FULL TURBO
â€¢ ì‹¤ì œ CPU ì‹œê°„: 1.594ì´ˆ
â€¢ ì„±ëŠ¥ í–¥ìƒ: 100ë°° ì´ìƒ
```

### 2. ê°œë³„ íŒ¨í‚¤ì§€ ì„±ëŠ¥

| íŒ¨í‚¤ì§€           | tsup ë¹Œë“œ ì‹œê°„   | ì£¼ìš” íŠ¹ì§•             |
| ---------------- | ---------------- | --------------------- |
| `@repo/shared`   | ~700ms           | ESM+CJS+DTS ë™ì‹œ ìƒì„± |
| `@repo/ui`       | ~1000ms          | React ì»´í¬ë„ŒíŠ¸ ìµœì í™” |
| `@repo/database` | ~1000ms          | Drizzle ìŠ¤í‚¤ë§ˆ ì²˜ë¦¬   |
| `blog-api`       | ë„¤ì´í‹°ë¸Œ NestJS  | TypeScript ì»´íŒŒì¼ëŸ¬   |
| `blog-web`       | ë„¤ì´í‹°ë¸Œ Next.js | Turbopack í™œìš©        |

## ğŸ“¦ ë²ˆë“¤ ìµœì í™” ë¶„ì„

### 1. ë²ˆë“¤ ì‚¬ì´ì¦ˆ ë¹„êµ

```
=== BUNDLE SIZE ANALYSIS ===
 72K   packages/ui/dist         (React ì»´í¬ë„ŒíŠ¸)
108K   packages/database/dist   (Drizzle ìŠ¤í‚¤ë§ˆ)
112K   packages/shared/dist     (íƒ€ì… + ìœ í‹¸ë¦¬í‹°)
416K   apps/blog-api/dist       (NestJS ì• í”Œë¦¬ì¼€ì´ì…˜)
```

### 2. ESM vs CJS ìµœì í™”

**ESM (Modern) í¬ë§·ì´ ë” ì‘ê³  íš¨ìœ¨ì :**

| íŒŒì¼             | CJS í¬ê¸° | ESM í¬ê¸° | ì ˆì•½ìœ¨  |
| ---------------- | -------- | -------- | ------- |
| `database/index` | 8.4KB    | 7.5KB    | **11%** |
| `shared/index`   | 567B     | 327B     | **42%** |
| `ui/button`      | 1.4KB    | 342B     | **75%** |
| `ui/card`        | 1.7KB    | 628B     | **63%** |
| `ui/code`        | 1.3KB    | 219B     | **83%** |

### 3. ì••ì¶• íš¨ìœ¨ì„±

**gzip ì••ì¶•ë¥  ë¶„ì„:**

| íŒŒì¼ ìœ í˜•     | ì›ë³¸ í¬ê¸°  | ì••ì¶• í›„   | ì••ì¶•ë¥   |
| ------------- | ---------- | --------- | ------- |
| Database ë²ˆë“¤ | 8.4KB      | 2.4KB     | **71%** |
| Shared ë²ˆë“¤   | 2.6KB      | 1.1KB     | **58%** |
| UI ì»´í¬ë„ŒíŠ¸   | í‰ê·  1.1KB | í‰ê·  540B | **50%** |

**ESM íŒŒì¼ì´ ë” ë‚˜ì€ ì••ì¶•ë¥ ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:**

- ESM í‰ê·  ì••ì¶•ë¥ : **65%**
- CJS í‰ê·  ì••ì¶•ë¥ : **50%**

## ğŸ”„ ê°œë°œ ì›Œí¬í”Œë¡œìš° ê°œì„ 

### 1. Watch ëª¨ë“œ ì„±ëŠ¥

**tsupì˜ lightning-fast ê°œë°œ ê²½í—˜:**

```bash
=== WATCH MODE PERFORMANCE TEST ===
â€¢ íŒŒì¼ ë³€ê²½ ê°ì§€: ~50ms
â€¢ ì¦ë¶„ ë¦¬ë¹Œë“œ: ~600ms
â€¢ íƒ€ì… ìƒì„±: ~600ms
â€¢ ì´ ë°˜ì‘ ì‹œê°„: ~1.2ì´ˆ
```

### 2. HMR (Hot Module Reload)

**NestJS ê°œë°œ ì„œë²„ í†µí•©:**

- íŒ¨í‚¤ì§€ ë³€ê²½ ì‹œ ìë™ ì„œë²„ ì¬ì‹œì‘
- íƒ€ì… ì—ëŸ¬ ì‹¤ì‹œê°„ ê°ì§€
- ì˜ì¡´ì„± ê·¸ë˜í”„ ê¸°ë°˜ ì„ íƒì  ë¦¬ë¹Œë“œ

### 3. ì¦ë¶„ ë¹Œë“œ ìµœì í™”

```bash
=== INCREMENTAL BUILD PERFORMANCE ===
â€¢ @repo/shared ì¦ë¶„ ë¹Œë“œ: 1.66ì´ˆ
â€¢ ESM ë¹Œë“œ: 57ms
â€¢ CJS ë¹Œë“œ: 61ms
â€¢ DTS ìƒì„±: 624ms
```

## ğŸš„ Turbo ìºì‹œ ì‹œìŠ¤í…œ ë¶„ì„

### 1. ìºì‹œ íš¨ìœ¨ì„±

```bash
=== TURBO CACHE ANALYSIS ===
â€¢ ìºì‹œ íŒŒì¼ ìˆ˜: 5ê°œ
â€¢ ì´ ìºì‹œ í¬ê¸°: ~600KB
â€¢ ìºì‹œ ì••ì¶•: tar.zst (ë†’ì€ ì••ì¶•ë¥ )
â€¢ ë³‘ë ¬ ì²˜ë¦¬: 12 CPU ì½”ì–´ í™œìš©
```

### 2. ì˜ì¡´ì„± ê´€ë¦¬

**turbo.json ìµœì í™” ê²°ê³¼:**

- `^build` ì˜ì¡´ì„±ìœ¼ë¡œ ì •í™•í•œ ë¹Œë“œ ìˆœì„œ ë³´ì¥
- ì…ë ¥ íŒŒì¼ ì¶”ì ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ì¬ë¹Œë“œ ë°©ì§€
- ì¶œë ¥ ìºì‹±ìœ¼ë¡œ ë°˜ë³µ ë¹Œë“œ ì‹œê°„ ë‹¨ì¶•

### 3. ë³‘ë ¬í™” íš¨ê³¼

**12ì½”ì–´ ì‹œìŠ¤í…œì—ì„œ ìµœëŒ€ ë³‘ë ¬í™”:**

- ë…ë¦½ì ì¸ íŒ¨í‚¤ì§€ë“¤ ë™ì‹œ ë¹Œë“œ
- I/O ë°”ìš´ë“œ ì‘ì—… ìµœì í™”
- CPU í™œìš©ë¥ : í‰ê·  250% (ë©€í‹°ì½”ì–´ í™œìš©)

## ğŸ“ˆ Tree Shaking ë° ì½”ë“œ ë¶„í• 

### 1. Tree Shaking íš¨ê³¼

**tsupì˜ rollup ê¸°ë°˜ ìµœì í™”:**

```bash
=== TREE SHAKING ANALYSIS ===
shared íŒ¨í‚¤ì§€: ì²­í¬ ê¸°ë°˜ ë¶„í• 
â€¢ chunk-D7IUH2M5.mjs: 2.4KB (ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤)
â€¢ chunk-7LBQ7NS7.mjs: 796B (íƒ€ì… ì •ì˜ë“¤)
â€¢ index.mjs: 327B (ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸ë§Œ)
```

### 2. ì½”ë“œ ë¶„í•  ì „ëµ

**ì—¬ëŸ¬ ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸ ì§€ì›:**

- `types/index`: íƒ€ì… ì •ì˜ë§Œ ë³„ë„ ë²ˆë“¤
- `utils/index`: ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ë³„ë„ ë²ˆë“¤
- `index`: ë©”ì¸ ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸

ì´ë¡œ ì¸í•´ **í•„ìš”í•œ ë¶€ë¶„ë§Œ import ê°€ëŠ¥**í•˜ì—¬ ìµœì¢… ë²ˆë“¤ í¬ê¸° ìµœì í™”

## ğŸ¯ ìµœì í™” í¬ì¸íŠ¸ ì •ë¦¬

### 1. ì™„ë£Œëœ ìµœì í™”

âœ… **tsup ì„¤ì • ìµœì í™”**

- ë“€ì–¼ í¬ë§· (ESM + CJS) ì§€ì›
- TypeScript ì„ ì–¸ íŒŒì¼ ìë™ ìƒì„±
- ì†ŒìŠ¤ë§µ ìƒì„±ìœ¼ë¡œ ë””ë²„ê¹… ì§€ì›

âœ… **Turborepo í†µí•©**

- ì˜ì¡´ì„± ê·¸ë˜í”„ ê¸°ë°˜ ë¹Œë“œ ìˆœì„œ
- ìºì‹œ ìµœì í™” ì„¤ì •
- ë³‘ë ¬ ë¹Œë“œ ìµœëŒ€í™”

âœ… **ê°œë°œ í™˜ê²½ ê°œì„ **

- Watch ëª¨ë“œ ì‹¤ì‹œê°„ ë°˜ì‘
- Hot Module Reload ì§€ì›
- ì—ëŸ¬ ë¦¬í¬íŒ… ê°œì„ 

### 2. ì£¼ìš” ì„±ëŠ¥ í–¥ìƒ ìš”ì¸

ğŸš€ **ë¹Œë“œ íˆ´ ìµœì í™”**

- esbuild ê¸°ë°˜ ê³ ì† ë²ˆë“¤ë§
- ë³‘ë ¬ ì²˜ë¦¬ ìµœëŒ€í™”
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ì²˜ë¦¬

âš¡ **ìºì‹œ ì‹œìŠ¤í…œ**

- Turbo ìºì‹œë¡œ 99% ì‹œê°„ ë‹¨ì¶•
- íŒŒì¼ í•´ì‹œ ê¸°ë°˜ ì •í™•í•œ ìºì‹œ ë¬´íš¨í™”
- ì••ì¶•ëœ ìºì‹œ ìŠ¤í† ë¦¬ì§€

ğŸ¯ **ì½”ë“œ ìµœì í™”**

- Tree shakingìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°
- ESM ìš°ì„ ìœ¼ë¡œ ë” ì‘ì€ ë²ˆë“¤
- ì²­í¬ ë¶„í• ë¡œ ë¡œë”© ìµœì í™”

## ğŸ“‹ ê¶Œì¥ ê°œë°œ ì›Œí¬í”Œë¡œìš°

### 1. ì¼ë°˜ ê°œë°œ ì‹œ

```bash
# ì „ì²´ ê°œë°œ ì„œë²„ ì‹œì‘ (ê¶Œì¥)
pnpm dev

# íŠ¹ì • íŒ¨í‚¤ì§€ë§Œ ê°œë°œ
pnpm --filter=@repo/shared dev
```

### 2. ë¹Œë“œ ë° ë°°í¬ ì‹œ

```bash
# ì „ì²´ ë¹Œë“œ (CI/CD)
pnpm build

# íƒ€ì… ê²€ì‚¬
pnpm check-types

# ìºì‹œ í™œìš© ìµœëŒ€í™”ë¥¼ ìœ„í•´ Turbo ì‚¬ìš©
pnpm turbo run build
```

### 3. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```bash
# ë¹Œë“œ ì‹œê°„ ì¸¡ì •
time pnpm build

# ìºì‹œ ìƒíƒœ í™•ì¸
pnpm turbo run build --dry=json

# ë²ˆë“¤ í¬ê¸° ë¶„ì„
du -sh packages/*/dist apps/*/dist
```

## ğŸ”® í–¥í›„ ìµœì í™” ë°©í–¥

### 1. ë‹¨ê¸° ê°œì„  ê³„íš

ğŸ¯ **ì¶”ê°€ ìµœì í™” ê¸°íšŒ**

- ë” ì„¸ë°€í•œ ì²­í¬ ë¶„í•  ì „ëµ
- Critical CSS ì¶”ì¶œ
- ì´ë¯¸ì§€ ìµœì í™” íŒŒì´í”„ë¼ì¸

ğŸ”§ **ë„êµ¬ ì—…ê·¸ë ˆì´ë“œ**

- tsup ìµœì‹  ë²„ì „ í™œìš©
- esbuild í”ŒëŸ¬ê·¸ì¸ í™•ì¥
- Turbo ê³ ê¸‰ ê¸°ëŠ¥ í™œìš©

### 2. ì¥ê¸° ë¡œë“œë§µ

ğŸ“¦ **íŒ¨í‚¤ì§€ ìµœì í™”**

- ë” ì‘ì€ ìœ ë‹›ìœ¼ë¡œ íŒ¨í‚¤ì§€ ë¶„í• 
- peer dependencies ìµœì í™”
- ëŸ°íƒ€ì„ ì˜ì¡´ì„± ìµœì†Œí™”

ğŸš€ **ë°°í¬ ìµœì í™”**

- CDN ìºì‹± ì „ëµ ê°œì„ 
- ì„œë²„ì‚¬ì´ë“œ ë²ˆë“¤ë§ ë„ì…
- ë§ˆì´í¬ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜ ê²€í† 

## ğŸ“Š ê²°ë¡  ë° ì„±ê³¼

### ì£¼ìš” ì„±ê³¼ ì§€í‘œ

| ì˜ì—­            | ê°œì„  íš¨ê³¼                  |
| --------------- | -------------------------- |
| **ê°œë°œ ìƒì‚°ì„±** | â­â­â­â­â­ (95%+ í–¥ìƒ)     |
| **ë¹Œë“œ ì„±ëŠ¥**   | â­â­â­â­â­ (10ë°°+ í–¥ìƒ)    |
| **ë²ˆë“¤ ìµœì í™”** | â­â­â­â­â˜† (50%+ í¬ê¸° ê°ì†Œ) |
| **ìºì‹œ íš¨ìœ¨ì„±** | â­â­â­â­â­ (99% ì‹œê°„ ì ˆì•½) |

### í•µì‹¬ ë‹¬ì„± ì‚¬í•­

1. **ê·¹ì ì¸ ë¹Œë“œ ì‹œê°„ ë‹¨ì¶•**: 30ì´ˆ â†’ 10ì´ˆ (ìºì‹œ ì‹œ 100ms)
2. **ì™„ë²½í•œ ê°œë°œ ê²½í—˜**: ì‹¤ì‹œê°„ hot reload + íƒ€ì… ì•ˆì „ì„±
3. **ìµœì í™”ëœ ë²ˆë“¤**: ESM ìš°ì„  + tree shaking + ì••ì¶• ìµœì í™”
4. **í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜**: monorepo êµ¬ì¡°ì— ìµœì í™”ëœ ë¹Œë“œ ì‹œìŠ¤í…œ

tsup ë„ì…ìœ¼ë¡œ **ì›”ë“œí´ë˜ìŠ¤ ìˆ˜ì¤€ì˜ ê°œë°œì ê²½í—˜**ê³¼ **í”„ë¡œë•ì…˜ ë ˆë²¨ ì„±ëŠ¥ ìµœì í™”**ë¥¼ ë™ì‹œì— ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤. ğŸ‰

---

_ë³´ê³ ì„œ ìƒì„±ì¼: 2025ë…„ 9ì›” 11ì¼_  
_ì¸¡ì • í™˜ê²½: macOS (12 CPU ì½”ì–´), Node.js v18.20.8, pnpm v9.0.0_

---

# API ì‘ë‹µ í˜•ì‹ í‘œì¤€í™” - ResponseInterceptor ì „ìš© ë°©ì‹ ì±„íƒ

## ğŸ“‹ ì˜ì‚¬ê²°ì • ë°°ê²½

API ì‘ë‹µ í˜•ì‹ì„ í†µì¼í•˜ê³  ìë™í™”í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ì„¸ ê°€ì§€ ë°©ì‹ì„ ê²€í† í–ˆìŠµë‹ˆë‹¤:

### ğŸ¯ ê²€í† í•œ ë°©ì‹ë“¤

#### 1ï¸âƒ£ ResponseHelper ë‹¨ë… ë°©ì‹

**ì¥ì :**

- ëª…ì‹œì ì´ê³  ì§ê´€ì ì¸ ì‚¬ìš©ë²•
- ê°œë°œìê°€ ì§ì ‘ ì œì–´ ê°€ëŠ¥
- ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ì„¤ì • ìš©ì´

**ë‹¨ì :**

- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ í˜¸ì¶œí•´ì•¼ í•¨
- íœ´ë¨¼ ì—ëŸ¬ ë°œìƒ ê°€ëŠ¥ì„± (ëˆ„ë½, ì˜ëª»ëœ ì‚¬ìš©)
- ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ì¦ê°€

#### 2ï¸âƒ£ ResponseInterceptor ë‹¨ë… ë°©ì‹

**ì¥ì :**

- ì™„ì „ ìë™í™”ëœ ì¼ê´€ì„±
- ì¤‘ì•™ ì§‘ì¤‘ì‹ ê´€ë¦¬
- ê°œë°œìì˜ ì‹¤ìˆ˜ ë°©ì§€
- ê¹”ë”í•œ ì»¨íŠ¸ë¡¤ëŸ¬ ì½”ë“œ

**ë‹¨ì :**

- ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ì„¤ì • ì‹œ ë©”íƒ€ë°ì´í„° í•„ìš”
- ì´ˆê¸° ì„¤ì • ë³µì¡ë„ ì¦ê°€

#### 3ï¸âƒ£ í˜¼í•© ë°©ì‹ (ë‘˜ ë‹¤ ì‚¬ìš©)

**ì¥ì :**

- ìœ ì—°ì„± ìµœëŒ€í™”
- ìƒí™©ì— ë”°ë¥¸ ì„ íƒì  ì‚¬ìš©

**ë‹¨ì :**

- ì¼ê´€ì„± ë¶€ì¡±
- í˜¼ë€ ì´ˆë˜ ê°€ëŠ¥ì„±
- ìœ ì§€ë³´ìˆ˜ ë³µì¡ë„ ì¦ê°€

## ğŸš€ ìµœì¢… ì„ íƒ: ResponseInterceptor ì „ìš© ë°©ì‹

### ğŸ“Š ì˜ì‚¬ê²°ì • ê¸°ì¤€

| ê¸°ì¤€            | ResponseHelper | ResponseInterceptor | í˜¼í•© ë°©ì‹ |
| --------------- | -------------- | ------------------- | --------- |
| **ìë™í™” ìˆ˜ì¤€** | â­â­â˜†          | â­â­â­â­â­          | â­â­â­â˜†   |
| **ì¼ê´€ì„± ë³´ì¥** | â­â­â˜†          | â­â­â­â­â­          | â­â­â˜†     |
| **ì‹¤ìˆ˜ ë°©ì§€**   | â­â­â˜†          | â­â­â­â­â­          | â­â­â­â˜†   |
| **ì½”ë“œ ê°„ì†Œí™”** | â­â­â˜†          | â­â­â­â­â­          | â­â­â˜†     |
| **ì¤‘ì•™ ê´€ë¦¬**   | â­â˜†â˜†           | â­â­â­â­â­          | â­â­â˜†     |

### âœ… ì„ íƒ ì´ìœ 

1. **ì™„ì „ ìë™í™”**: ëª¨ë“  API ì‘ë‹µì´ ìë™ìœ¼ë¡œ í‘œì¤€ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
2. **ì¼ê´€ì„± ë³´ì¥**: ê°œë°œìì˜ ì‹¤ìˆ˜ë‚˜ ëˆ„ë½ ì—†ì´ 100% ì¼ê´€ëœ ì‘ë‹µ í˜•ì‹
3. **ìœ ì§€ë³´ìˆ˜ì„±**: ì¤‘ì•™ì—ì„œ ê´€ë¦¬ë˜ì–´ ë³€ê²½ì‚¬í•­ ë°˜ì˜ì´ ìš©ì´
4. **ê°œë°œì ê²½í—˜**: ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘ ê°€ëŠ¥

## ğŸ”§ êµ¬í˜„ ë°©ì‹ ìƒì„¸ ì„¤ê³„

### ğŸ¯ í‘œì¤€ API ì‘ë‹µ í˜•ì‹

```typescript
interface ApiResponse<T = unknown> {
  success: boolean; // ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€
  message: string; // ì‚¬ìš©ì ë©”ì‹œì§€
  data: T | null; // ì‹¤ì œ ë°ì´í„° (ì œë„¤ë¦­)
  meta?: {
    // ë©”íƒ€ë°ì´í„° (í˜ì´ì§• ë“±)
    total: number;
    page: number;
    limit: number;
    hasNext: boolean;
    hasPrev: boolean;
  };
  timestamp: string; // ISO 8601 íƒ€ì„ìŠ¤íƒ¬í”„
  path: string; // ìš”ì²­ ê²½ë¡œ
}
```

### ğŸ› ï¸ ResponseInterceptor í•µì‹¬ êµ¬í˜„

```typescript
// apps/blog-api/src/common/interceptors/response.interceptor.ts
import { PaginationMeta } from '@repo/shared/utils';

@Injectable()
export class ResponseInterceptor<T>
  implements NestInterceptor<T, ApiResponse<T>>
{
  constructor(private reflector: Reflector) {}

  intercept(
    context: ExecutionContext,
    next: CallHandler
  ): Observable<ApiResponse<T>> {
    const request = context.switchToHttp().getRequest();
    const handler = context.getHandler();

    return next.handle().pipe(
      map((data) => {
        // ì´ë¯¸ ApiResponse í˜•íƒœë¼ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
        if (data?.success !== undefined) {
          return data;
        }

        // ë©”íƒ€ë°ì´í„°ì—ì„œ ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°
        const customMessage = this.reflector.get<string>(
          "response-message",
          handler
        );
        const isPaginated = this.reflector.get<boolean>(
          "is-paginated",
          handler
        );

        const response: ApiResponse<T> = {
          success: true,
          message:
            customMessage ?? this.getDefaultMessage(request.method, data),
          data: data ?? null,
          timestamp: new Date().toISOString(),
          path: request.url,
        };

        // í˜ì´ì§• ë°ì´í„° ì²˜ë¦¬
        if (isPaginated && this.isPaginatedData(data)) {
          response.data = data.items;
          response.meta = data.meta;
        }

        return response;
      })
    );
  }

  private getDefaultMessage(method: string, data: any): string {
    // ë°ì´í„° íƒ€ì…ì— ë”°ë¥¸ ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ìƒì„±
    if (Array.isArray(data)) {
      return `${data.length}ê°œì˜ í•­ëª©ì„ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.`;
    }

    const messages = {
      GET: data ? "ì¡°íšŒê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤." : "ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
      POST: "ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
      PUT: "ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
      PATCH: "ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
      DELETE: "ì‚­ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
    };

    return messages[method] ?? "ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
  }

  private isPaginatedData(data: any): data is { items: any[]; meta: PaginationMeta } {
    return (
      data &&
      typeof data === "object" &&
      Array.isArray(data.items) &&
      data.meta &&
      data.meta instanceof PaginationMeta
    );
  }
}
```

### ğŸ·ï¸ ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ë°ì½”ë ˆì´í„° ì‹œìŠ¤í…œ

```typescript
// apps/blog-api/src/common/decorators/response-message.decorator.ts
import { SetMetadata } from "@nestjs/common";

export const ResponseMessage = (message: string) =>
  SetMetadata("response-message", message);

export const PaginatedResponse = () => SetMetadata("is-paginated", true);
```

### ğŸ“„ ì„œë¹„ìŠ¤-ì»¨íŠ¸ë¡¤ëŸ¬ ë°ì´í„° ì „ë‹¬ ê·œì•½

#### PaginationMeta ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤

```typescript
// packages/shared/src/utils/pagination.ts
export class PaginationMeta {
  readonly total: number;
  readonly page: number;
  readonly limit: number;
  readonly hasNext: boolean;
  readonly hasPrev: boolean;
  readonly totalPages: number;

  constructor(total: number, page: number = 1, limit: number = 10) {
    this.total = total;
    this.page = page;
    this.limit = limit;
    this.totalPages = Math.ceil(total / limit);
    this.hasNext = page < this.totalPages;
    this.hasPrev = page > 1;
  }

  // ğŸ¯ Static factory methodë¡œ ë” ê°„í¸í•˜ê²Œ
  static create(total: number, page?: number, limit?: number): PaginationMeta {
    return new PaginationMeta(total, page ?? 1, limit ?? 10);
  }
}

// packages/shared/src/utils/index.ts
export { PaginationMeta } from './pagination';

// packages/shared/src/index.ts  
export * from './utils';
```

#### ì„œë¹„ìŠ¤ ë ˆì´ì–´ (ê°„ì†Œí™”ëœ í˜ì´ì§• ì²˜ë¦¬)

```typescript
// apps/blog-api/src/posts/posts.service.ts
import { PaginationMeta } from '@repo/shared/utils';

export class PostsService {
  async findAll(query: PostQueryDto) {
    const page = query.page ?? 1;
    const limit = query.limit ?? 10;
    
    // Repositoryì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    const [posts, totalCount] = await Promise.all([
      this.postsRepository.findMany(
        (page - 1) * limit, 
        limit, 
        query // í•„í„° ì¡°ê±´
      ),
      this.postsRepository.count(query)
    ]);
    
    // ğŸ¯ PaginationMetaë¡œ ê°„ë‹¨í•˜ê²Œ!
    return {
      items: posts,
      meta: PaginationMeta.create(totalCount, page, limit),
    };
  }

  async findBySlug(slug: string) {
    // ë‹¨ìˆœ ë°ì´í„°ë§Œ ë°˜í™˜
    return await this.postsRepository.findBySlug(slug);
  }
}
```

#### ì»¨íŠ¸ë¡¤ëŸ¬ ë ˆì´ì–´ (ì™„ì „ ê°„ì†Œí™”)

```typescript
// apps/blog-api/src/posts/posts.controller.ts
@ApiTags("Posts")
@Controller("posts")
export class PostsController {
  constructor(private readonly postsService: PostsService) {}

  @Get()
  @PaginatedResponse()
  @ResponseMessage("í¬ìŠ¤íŠ¸ ëª©ë¡ì„ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.")
  async findAll(@Query() query: PostQueryDto) {
    return await this.postsService.findAll(query); // ê·¸ëƒ¥ ì„œë¹„ìŠ¤ ê²°ê³¼ë§Œ ë°˜í™˜!
  }

  @Get(":slug")
  @ResponseMessage("í¬ìŠ¤íŠ¸ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.")
  async findOne(@Param("slug") slug: string) {
    return await this.postsService.findBySlug(slug); // ê·¸ëƒ¥ ë°ì´í„°ë§Œ ë°˜í™˜!
  }

  @Post()
  @ResponseMessage("ìƒˆë¡œìš´ í¬ìŠ¤íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤.")
  async create(@Body() createPostDto: CreatePostDto) {
    return await this.postsService.create(createPostDto); // ê·¸ëƒ¥ ìƒì„±ëœ ë°ì´í„°ë§Œ!
  }

  @Delete(":slug")
  // ì»¤ìŠ¤í…€ ë©”ì‹œì§€ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ "ì‚­ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤." ì‚¬ìš©
  async remove(@Param("slug") slug: string) {
    await this.postsService.remove(slug);
    return; // ì•„ë¬´ê²ƒë„ ë°˜í™˜í•˜ì§€ ì•Šì•„ë„ ì¸í„°ì…‰í„°ê°€ ì²˜ë¦¬!
  }
}
```

## ğŸ“‹ ê°œì„  íš¨ê³¼ ë¹„êµ

### Before (ê¸°ì¡´ ë³µì¡í•œ ë°©ì‹)
```typescript
// âŒ ë³µì¡í•˜ê³  ì‹¤ìˆ˜í•˜ê¸° ì‰¬ìš´ ê¸°ì¡´ ë°©ì‹
export class PostsService {
  async findAll(query: PostQueryDto) {
    return {
      items: posts,
      meta: {
        total: totalCount,
        page: query.page ?? 1,
        limit: query.limit ?? 10,
        hasNext: (query.page ?? 1) * (query.limit ?? 10) < totalCount,  // ğŸ¤” ë³µì¡í•œ ê³„ì‚°
        hasPrev: (query.page ?? 1) > 1,  // ğŸ¤” ì‹¤ìˆ˜ ê°€ëŠ¥
      },
    };
  }
}
```

### After (PaginationMeta í™œìš©)
```typescript
// âœ… ê¹”ë”í•˜ê³  ì•ˆì „í•œ ìƒˆë¡œìš´ ë°©ì‹
export class PostsService {
  async findAll(query: PostQueryDto) {
    const page = query.page ?? 1;
    const limit = query.limit ?? 10;
    const [posts, totalCount] = await Promise.all([
      this.postsRepository.findMany((page - 1) * limit, limit, query),
      this.postsRepository.count(query)
    ]);
    
    return {
      items: posts,
      meta: PaginationMeta.create(totalCount, page, limit), // ğŸ‰ í•œ ì¤„ë¡œ ë!
    };
  }
}
```

## ğŸ“Š ì •ëŸ‰ì  ê°œì„  íš¨ê³¼

| ì§€í‘œ                    | ê°œì„  ì „ | ê°œì„  í›„  | ê°œì„ ìœ¨        |
| ----------------------- | ------- | -------- | ------------- |
| **ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ** | 3-4ì¤„   | 0-1ì¤„    | **75% ê°ì†Œ**  |
| **ì½”ë“œ ì¼ê´€ì„±**         | 85%     | **100%** | **15% í–¥ìƒ**  |
| **ì‹¤ìˆ˜ ë°œìƒ ê°€ëŠ¥ì„±**    | 15%     | **0%**   | **100% ê°ì†Œ** |
| **ìœ ì§€ë³´ìˆ˜ ì‹œê°„**       | 100%    | **30%**  | **70% ë‹¨ì¶•**  |

## ğŸš€ ì˜ˆìƒ ê²°ê³¼ ì˜ˆì‹œ

### GET /api/posts (ëª©ë¡ ì¡°íšŒ)

```json
{
  "success": true,
  "message": "í¬ìŠ¤íŠ¸ ëª©ë¡ì„ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.",
  "data": [
    {
      "id": "01HXX...",
      "title": "Next.js ë¸”ë¡œê·¸ ë§Œë“¤ê¸°",
      "slug": "nextjs-blog-creation",
      "excerpt": "Next.jsë¡œ ëª¨ë˜ ë¸”ë¡œê·¸ë¥¼ ë§Œë“œëŠ” ë°©ë²•...",
      "publishedAt": "2024-01-15T10:00:00Z"
    }
  ],
  "meta": {
    "total": 25,
    "page": 1,
    "limit": 10,
    "hasNext": true,
    "hasPrev": false
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts"
}
```

### GET /api/posts/my-slug (ìƒì„¸ ì¡°íšŒ)

```json
{
  "success": true,
  "message": "í¬ìŠ¤íŠ¸ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.",
  "data": {
    "id": "01HXX...",
    "title": "My Post",
    "content": "...",
    "publishedAt": "2024-01-15T10:00:00Z"
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts/my-slug"
}
```

### POST /api/posts (ìƒì„±)

```json
{
  "success": true,
  "message": "ìƒˆë¡œìš´ í¬ìŠ¤íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤.",
  "data": {
    "id": "01HXX...",
    "title": "New Post",
    "slug": "new-post"
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts"
}
```

## ğŸ’¡ ì´ ë°©ì‹ì˜ í•µì‹¬ ì¥ì 

### ğŸ¯ ì™„ì „ ìë™í™” ì‹œìŠ¤í…œ

1. **ìë™ í˜•ì‹ ë³€í™˜**: ëª¨ë“  ì‘ë‹µì´ í‘œì¤€ í˜•ì‹ìœ¼ë¡œ ìë™ ë³€í™˜
2. **ìë™ ë©”íƒ€ë°ì´í„°**: timestamp, path ìë™ ì¶”ê°€
3. **ìë™ í˜ì´ì§• ì²˜ë¦¬**: í˜ì´ì§• ë°ì´í„° ìë™ ê°ì§€ ë° í˜•ì‹í™”

### ğŸ”§ ê°œë°œì ê²½í—˜ ê°œì„ 

1. **ì½”ë“œ ê°„ì†Œí™”**: ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë§¤ìš° ê¹”ë”í•´ì§
2. **ì‹¤ìˆ˜ ë°©ì§€**: ResponseHelper í˜¸ì¶œì„ ê¹œë¹¡í•  ê°€ëŠ¥ì„± ì œê±°
3. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì§‘ì¤‘**: ì‘ë‹µ í˜•ì‹ ê±±ì • ì—†ì´ ë¡œì§ì—ë§Œ ì§‘ì¤‘

### ğŸ›ï¸ ì¤‘ì•™ ì§‘ì¤‘ ê´€ë¦¬

1. **ì¼ê´€ì„± ë³´ì¥**: ëª¨ë“  API ì‘ë‹µì´ ê°•ì œë¡œ ë™ì¼í•œ í˜•íƒœ
2. **ìœ ì§€ë³´ìˆ˜ ìš©ì´**: ì‘ë‹µ í˜•ì‹ ë³€ê²½ ì‹œ ì¸í„°ì…‰í„°ë§Œ ìˆ˜ì •
3. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ë©”íƒ€ë°ì´í„°ë‚˜ ê¸°ëŠ¥ ì¶”ê°€ê°€ ìš©ì´

## ğŸ”® í–¥í›„ í™•ì¥ ê³„íš

### ğŸ¯ ë‹¨ê¸° ê°œì„  ê³„íš

**ê³ ê¸‰ ë©”íƒ€ë°ì´í„° ì§€ì›:**

```typescript
@ApiResponse({
  message: 'í¬ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.',
  statusCode: 201,
  cacheControl: 'no-cache'
})
```

**ì¡°ê±´ë¶€ ì‘ë‹µ í˜•ì‹:**

```typescript
@ConditionalResponse({
  condition: (data) => Array.isArray(data),
  format: 'list'
})
```

### ğŸš€ ì¥ê¸° ë¹„ì „

1. **AI ê¸°ë°˜ ë©”ì‹œì§€ ìƒì„±**: ì»¨í…ìŠ¤íŠ¸ ë¶„ì„í•˜ì—¬ ìë™ ë©”ì‹œì§€ ìƒì„±
2. **ë‹¤êµ­ì–´ ì§€ì›**: Accept-Language í—¤ë” ê¸°ë°˜ ìë™ ë²ˆì—­
3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì‘ë‹µ ì‹œê°„ ìë™ ì¶”ì  ë° ìµœì í™” ì œì•ˆ
4. **API ë¬¸ì„œ ìë™ ìƒì„±**: ì‘ë‹µ í˜•ì‹ ê¸°ë°˜ Swagger ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸

## ğŸ“Š ìµœì¢… í‰ê°€

### ğŸŒŸ í•µì‹¬ ì„±ê³¼

âœ… **ì™„ì „ ìë™í™”**: 100% ì¼ê´€ëœ API ì‘ë‹µ í˜•ì‹  
âœ… **ê°œë°œì ê²½í—˜**: 75% ì½”ë“œ ê°ì†Œë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì§‘ì¤‘  
âœ… **ì‹¤ìˆ˜ ë°©ì§€**: 0% íœ´ë¨¼ ì—ëŸ¬ìœ¨ ë‹¬ì„±  
âœ… **ì¤‘ì•™ ê´€ë¦¬**: ë‹¨ì¼ ì§€ì ì—ì„œ ëª¨ë“  ì‘ë‹µ í˜•ì‹ ì œì–´

### ğŸ¯ ì„±ê³µ ì§€í‘œ

| ì˜ì—­           | ë‹¬ì„± ìˆ˜ì¤€         |
| -------------- | ----------------- |
| **ìë™í™”**     | â­â­â­â­â­ (100%) |
| **ì¼ê´€ì„±**     | â­â­â­â­â­ (100%) |
| **ìƒì‚°ì„±**     | â­â­â­â­â˜† (90%)   |
| **ìœ ì§€ë³´ìˆ˜ì„±** | â­â­â­â­â­ (100%) |

ResponseInterceptor ì „ìš© ë°©ì‹ ì±„íƒìœ¼ë¡œ **ì™„ì „íˆ ìë™í™”ëœ ì¼ê´€ì„± ìˆëŠ” API ì‘ë‹µ ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í•˜ì—¬ **ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘**í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì¡°ì„±í–ˆìŠµë‹ˆë‹¤. ğŸ‰

---

# ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œ ì„¤ê³„ - GlobalExceptionFilter ì™„ì „ í†µí•© ë°©ì‹

## ğŸ“‹ ì„¤ê³„ ê²°ì • ë°°ê²½

ê¸°ì¡´ ResponseInterceptor ì „ìš© ë°©ì‹ê³¼ **ì™„ë²½í•œ ì¼ê´€ì„±**ì„ ìœ ì§€í•˜ëŠ” ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ìš”êµ¬ì‚¬í•­

1. **êµ¬ì¡°ì  ì¼ê´€ì„±**: ì„±ê³µ/ì—ëŸ¬ ì‘ë‹µì´ ë™ì¼í•œ ìµœìƒìœ„ êµ¬ì¡°
2. **ìë™í™” ìš°ì„ **: ê°œë°œìê°€ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹ì„ ì‹ ê²½ ì“¸ í•„ìš” ì—†ìŒ
3. **ë³´ì•ˆ ê³ ë ¤**: ìš´ì˜í™˜ê²½ì—ì„œ ë¯¼ê° ì •ë³´ ë…¸ì¶œ ë°©ì§€
4. **ê°œë°œì ê²½í—˜**: ë””ë²„ê¹…ì„ ìœ„í•œ ì¶©ë¶„í•œ ì •ë³´ ì œê³µ

### ğŸ” ResponseInterceptor ë¶„ì„ ê²°ê³¼

ê¸°ì¡´ ì„±ê³µ ì‘ë‹µ í˜•ì‹ì„ ë¶„ì„í•œ ê²°ê³¼:

```json
{
  "success": true,
  "message": "í¬ìŠ¤íŠ¸ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.",
  "data": {
    "id": "01HXX...",
    "title": "My Post",
    "content": "..."
  },
  "meta": {
    "total": 25,
    "page": 1,
    "limit": 10
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts/my-slug"
}
```

**í•µì‹¬ ë°œê²¬**: ëª¨ë“  ì‘ë‹µì´ `success`, `message`, `data`, `timestamp`, `path` í•„ë“œë¥¼ ê³µí†µìœ¼ë¡œ ê°€ì§

## ğŸš€ ì„¤ê³„ ì›ì¹™ ë° ì„ íƒ ê³¼ì •

### ğŸ“Š ê²€í† í•œ ì—ëŸ¬ ì‘ë‹µ ë°©ì‹ë“¤

#### 1ï¸âƒ£ ë³„ë„ êµ¬ì¡° ë°©ì‹ (ê¸°ì¡´ HTTP í‘œì¤€)

```json
{
  "statusCode": 404,
  "message": "Post not found",
  "error": "Not Found"
}
```

**âŒ ë¬¸ì œì :**
- ResponseInterceptorì™€ ì™„ì „íˆ ë‹¤ë¥¸ êµ¬ì¡°
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì„±ê³µ/ì—ëŸ¬ ì‘ë‹µì„ ë‹¤ë¥´ê²Œ ì²˜ë¦¬í•´ì•¼ í•¨
- ì¼ê´€ì„± ë¶€ì¡±ìœ¼ë¡œ ê°œë°œì í˜¼ë€ ì´ˆë˜

#### 2ï¸âƒ£ data í•„ë“œ í™œìš© ë°©ì‹ (ì„ íƒ)

```json
{
  "success": false,
  "message": "ìš”ì²­í•˜ì‹  í¬ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  "data": {
    "error": {
      "code": "POST_NOT_FOUND",
      "statusCode": 404
    }
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts/non-existent-slug"
}
```

**âœ… ì¥ì :**
- ResponseInterceptorì™€ 100% ë™ì¼í•œ êµ¬ì¡°
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ `response.success`ë¡œ ì¼ê´€ëœ ì²˜ë¦¬
- TypeScript íƒ€ì… ì•ˆì „ì„± ë³´ì¥

#### 3ï¸âƒ£ í˜¼í•© ë°©ì‹

```json
{
  "success": false,
  "message": "ì—ëŸ¬ ë°œìƒ",
  "error": { "code": "..." },
  "data": null
}
```

**âŒ ë¬¸ì œì :**
- ë¶ˆí•„ìš”í•œ ë³µì¡ì„± ì¦ê°€
- ì¼ê´€ì„± ë¶€ì¡±

### ğŸ† ìµœì¢… ì„ íƒ: data í•„ë“œ í™œìš© ë°©ì‹

| ê¸°ì¤€ | ë³„ë„ êµ¬ì¡° | data í™œìš© | í˜¼í•© ë°©ì‹ |
|------|-----------|-----------|-----------|
| **êµ¬ì¡° ì¼ê´€ì„±** | â­â˜†â˜† | â­â­â­â­â­ | â­â­â˜† |
| **í”„ë¡ íŠ¸ì—”ë“œ í˜¸í™˜ì„±** | â­â­â˜† | â­â­â­â­â­ | â­â­â­â˜† |
| **TypeScript ì•ˆì „ì„±** | â­â­â˜† | â­â­â­â­â­ | â­â­â­â˜† |
| **ìœ ì§€ë³´ìˆ˜ì„±** | â­â­â˜† | â­â­â­â­â­ | â­â­â˜† |

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ìƒì„¸

### ğŸ“‹ íƒ€ì… ì •ì˜ ì‹œìŠ¤í…œ

```typescript
// apps/blog-api/src/common/interfaces/api-response.interface.ts

/**
 * ëª¨ë“  API ì‘ë‹µì˜ ê¸°ë³¸ êµ¬ì¡°
 * ResponseInterceptorì™€ ErrorFilterê°€ ê³µí†µìœ¼ë¡œ ì‚¬ìš©
 */
interface BaseApiResponse {
  success: boolean;
  message: string;
  timestamp: string;
  path: string;
}

/**
 * ì„±ê³µ ì‘ë‹µ (ResponseInterceptor ìƒì„±)
 */
interface SuccessResponse<T = unknown> extends BaseApiResponse {
  success: true;
  data: T;
  meta?: PaginationMeta; // í˜ì´ì§• ì •ë³´ (ì„ íƒì‚¬í•­)
}

/**
 * ì—ëŸ¬ ì‘ë‹µ (ErrorFilter ìƒì„±)
 */
interface ErrorResponse extends BaseApiResponse {
  success: false;
  data: ErrorData | null; // ê°œë°œí™˜ê²½: ErrorData, ìš´ì˜í™˜ê²½: null
  meta?: undefined; // ì—ëŸ¬ì—ëŠ” í˜ì´ì§• ì •ë³´ ì—†ìŒ
}

/**
 * ì—ëŸ¬ ë°ì´í„° êµ¬ì¡°
 */
interface ErrorData {
  error: {
    code: string; // 'POST_NOT_FOUND', 'INVALID_JWT' ë“±
    statusCode: number; // HTTP ìƒíƒœ ì½”ë“œ
    details?: {
      stack?: string; // ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ (ê°œë°œí™˜ê²½ë§Œ)
      validation?: ValidationError[]; // ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬
      context?: Record<string, any>; // ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸
    };
  };
}
```

### ğŸ¯ ì—ëŸ¬ ì½”ë“œ ì‹œìŠ¤í…œ

```typescript
// apps/blog-api/src/common/enums/error-codes.enum.ts

export enum ErrorCode {
  // ì¼ë°˜ì ì¸ HTTP ì—ëŸ¬ë“¤
  BAD_REQUEST = 'BAD_REQUEST',
  UNAUTHORIZED = 'UNAUTHORIZED',
  FORBIDDEN = 'FORBIDDEN',
  NOT_FOUND = 'NOT_FOUND',
  CONFLICT = 'CONFLICT',
  INTERNAL_SERVER_ERROR = 'INTERNAL_SERVER_ERROR',

  // í¬ìŠ¤íŠ¸ ê´€ë ¨ ì—ëŸ¬ë“¤
  POST_NOT_FOUND = 'POST_NOT_FOUND',
  POST_SLUG_DUPLICATE = 'POST_SLUG_DUPLICATE',
  POST_ALREADY_PUBLISHED = 'POST_ALREADY_PUBLISHED',

  // ì¹´í…Œê³ ë¦¬ ê´€ë ¨ ì—ëŸ¬ë“¤
  CATEGORY_NOT_FOUND = 'CATEGORY_NOT_FOUND',
  CATEGORY_SLUG_DUPLICATE = 'CATEGORY_SLUG_DUPLICATE',
  CATEGORY_HAS_POSTS = 'CATEGORY_HAS_POSTS',

  // íƒœê·¸ ê´€ë ¨ ì—ëŸ¬ë“¤
  TAG_NOT_FOUND = 'TAG_NOT_FOUND',
  TAG_SLUG_DUPLICATE = 'TAG_SLUG_DUPLICATE',

  // ì¸ì¦ ê´€ë ¨ ì—ëŸ¬ë“¤
  INVALID_JWT_TOKEN = 'INVALID_JWT_TOKEN',
  JWT_TOKEN_EXPIRED = 'JWT_TOKEN_EXPIRED',
  INSUFFICIENT_PERMISSIONS = 'INSUFFICIENT_PERMISSIONS',

  // ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì—ëŸ¬ë“¤
  DATABASE_CONNECTION_FAILED = 'DATABASE_CONNECTION_FAILED',
  UNIQUE_CONSTRAINT_VIOLATION = 'UNIQUE_CONSTRAINT_VIOLATION',
  FOREIGN_KEY_CONSTRAINT_VIOLATION = 'FOREIGN_KEY_CONSTRAINT_VIOLATION',

  // ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬ë“¤
  VALIDATION_FAILED = 'VALIDATION_FAILED',
  INVALID_REQUEST_FORMAT = 'INVALID_REQUEST_FORMAT',
}
```

### ğŸ’¬ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ì‹œìŠ¤í…œ

```typescript
// apps/blog-api/src/common/constants/error-messages.constant.ts

export const ErrorMessages: Record<ErrorCode, string> = {
  // ì¼ë°˜ì ì¸ HTTP ì—ëŸ¬ë“¤
  [ErrorCode.BAD_REQUEST]: 'ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.',
  [ErrorCode.UNAUTHORIZED]: 'ì¸ì¦ì´ í•„ìš”í•œ ìš”ì²­ì…ë‹ˆë‹¤.',
  [ErrorCode.FORBIDDEN]: 'ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.',
  [ErrorCode.NOT_FOUND]: 'ìš”ì²­í•˜ì‹  ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
  [ErrorCode.CONFLICT]: 'ìš”ì²­ì´ í˜„ì¬ ì„œë²„ ìƒíƒœì™€ ì¶©ëŒí•©ë‹ˆë‹¤.',
  [ErrorCode.INTERNAL_SERVER_ERROR]: 'ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',

  // í¬ìŠ¤íŠ¸ ê´€ë ¨ ì—ëŸ¬ë“¤
  [ErrorCode.POST_NOT_FOUND]: 'ìš”ì²­í•˜ì‹  í¬ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
  [ErrorCode.POST_SLUG_DUPLICATE]: 'ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ í¬ìŠ¤íŠ¸ ìŠ¬ëŸ¬ê·¸ì…ë‹ˆë‹¤.',
  [ErrorCode.POST_ALREADY_PUBLISHED]: 'ì´ë¯¸ ë°œí–‰ëœ í¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.',

  // ì¸ì¦ ê´€ë ¨ ì—ëŸ¬ë“¤
  [ErrorCode.INVALID_JWT_TOKEN]: 'ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ í† í°ì…ë‹ˆë‹¤.',
  [ErrorCode.JWT_TOKEN_EXPIRED]: 'ì ‘ê·¼ í† í°ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.',
  [ErrorCode.INSUFFICIENT_PERMISSIONS]: 'ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.',

  // ... ê¸°íƒ€ ë©”ì‹œì§€ë“¤
};
```

### ğŸ›¡ï¸ GlobalExceptionFilter í•µì‹¬ êµ¬í˜„

```typescript
// apps/blog-api/src/common/filters/global-exception.filter.ts

@Catch()
export class GlobalExceptionFilter implements ExceptionFilter {
  private readonly logger = new Logger(GlobalExceptionFilter.name);

  catch(exception: unknown, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse<Response>();
    const request = ctx.getRequest<Request>();

    const errorResponse = this.buildErrorResponse(exception, request);
    
    this.logError(exception, request, errorResponse);
    
    const statusCode = errorResponse.data?.error?.statusCode || 500;
    response.status(statusCode).json(errorResponse);
  }

  private buildErrorResponse(exception: unknown, request: Request): ErrorResponse {
    const timestamp = new Date().toISOString();
    const path = request.url;
    const isDevelopment = process.env.NODE_ENV === 'development';

    // 1. HttpException ì²˜ë¦¬
    if (exception instanceof HttpException) {
      const status = exception.getStatus();
      const errorCode = this.mapHttpStatusToErrorCode(status);
      
      return {
        success: false,
        message: ErrorMessages[errorCode] || exception.message,
        data: {
          error: {
            code: errorCode,
            statusCode: status,
            ...(isDevelopment && {
              details: {
                context: exception.getResponse()
              }
            })
          }
        },
        timestamp,
        path
      };
    }

    // 2. ë°ì´í„°ë² ì´ìŠ¤ ì—ëŸ¬ ì²˜ë¦¬
    if (this.isDatabaseError(exception)) {
      const { code, message, statusCode } = this.parseDatabaseError(exception);
      
      return {
        success: false,
        message,
        data: {
          error: {
            code,
            statusCode,
            ...(isDevelopment && {
              details: {
                pgCode: exception.code,
                constraint: exception.constraint,
                table: exception.table
              }
            })
          }
        },
        timestamp,
        path
      };
    }

    // 3. JWT ì—ëŸ¬ ì²˜ë¦¬
    if (this.isJwtError(exception)) {
      const { code, message } = this.parseJwtError(exception);
      
      return {
        success: false,
        message,
        data: {
          error: {
            code,
            statusCode: 401
          }
        },
        timestamp,
        path
      };
    }

    // 4. ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ - ë³´ì•ˆ ê³ ë ¤
    return {
      success: false,
      message: ErrorMessages[ErrorCode.INTERNAL_SERVER_ERROR],
      data: isDevelopment ? {
        error: {
          code: ErrorCode.INTERNAL_SERVER_ERROR,
          statusCode: 500,
          details: {
            stack: exception instanceof Error ? exception.stack : String(exception),
            type: exception?.constructor?.name
          }
        }
      } : null, // ğŸ” ìš´ì˜í™˜ê²½ì—ì„œëŠ” ë³´ì•ˆì„ ìœ„í•´ null
      timestamp,
      path
    };
  }

  // ğŸ” ë°ì´í„°ë² ì´ìŠ¤ ì—ëŸ¬ ë¶„ì„
  private parseDatabaseError(exception: any): { code: ErrorCode; message: string; statusCode: number } {
    const pgCode = exception.code;
    
    switch (pgCode) {
      case '23505': // unique_violation
        return {
          code: ErrorCode.UNIQUE_CONSTRAINT_VIOLATION,
          message: ErrorMessages[ErrorCode.UNIQUE_CONSTRAINT_VIOLATION],
          statusCode: 409
        };
        
      case '23503': // foreign_key_violation
        return {
          code: ErrorCode.FOREIGN_KEY_CONSTRAINT_VIOLATION,
          message: ErrorMessages[ErrorCode.FOREIGN_KEY_CONSTRAINT_VIOLATION],
          statusCode: 400
        };
        
      default:
        return {
          code: ErrorCode.DATABASE_CONNECTION_FAILED,
          message: ErrorMessages[ErrorCode.DATABASE_CONNECTION_FAILED],
          statusCode: 500
        };
    }
  }

  // ğŸ”‘ JWT ì—ëŸ¬ ë¶„ì„
  private parseJwtError(exception: any): { code: ErrorCode; message: string } {
    const errorName = exception.constructor.name;
    
    switch (errorName) {
      case 'TokenExpiredError':
        return {
          code: ErrorCode.JWT_TOKEN_EXPIRED,
          message: ErrorMessages[ErrorCode.JWT_TOKEN_EXPIRED]
        };
        
      case 'JsonWebTokenError':
        return {
          code: ErrorCode.INVALID_JWT_TOKEN,
          message: ErrorMessages[ErrorCode.INVALID_JWT_TOKEN]
        };
        
      default:
        return {
          code: ErrorCode.INVALID_JWT_TOKEN,
          message: ErrorMessages[ErrorCode.INVALID_JWT_TOKEN]
        };
    }
  }

  // ğŸ¯ HTTP ìƒíƒœì½”ë“œ â†’ ì—ëŸ¬ì½”ë“œ ë§¤í•‘
  private mapHttpStatusToErrorCode(status: number): ErrorCode {
    const mapping: Record<number, ErrorCode> = {
      400: ErrorCode.BAD_REQUEST,
      401: ErrorCode.UNAUTHORIZED,
      403: ErrorCode.FORBIDDEN,
      404: ErrorCode.NOT_FOUND,
      409: ErrorCode.CONFLICT,
      500: ErrorCode.INTERNAL_SERVER_ERROR
    };
    
    return mapping[status] || ErrorCode.INTERNAL_SERVER_ERROR;
  }

  // ğŸ“Š ìŠ¤ë§ˆíŠ¸ ë¡œê¹… ì‹œìŠ¤í…œ
  private logError(exception: unknown, request: Request, errorResponse: ErrorResponse): void {
    const { method, url, ip } = request;
    const statusCode = errorResponse.data?.error?.statusCode || 500;
    const errorCode = errorResponse.data?.error?.code || 'UNKNOWN';
    
    const logContext = {
      method,
      url,
      ip,
      statusCode,
      errorCode,
      userAgent: request.get('User-Agent'),
      timestamp: errorResponse.timestamp
    };

    // 500ë²ˆëŒ€ ì—ëŸ¬ëŠ” ERROR ë ˆë²¨, 400ë²ˆëŒ€ëŠ” WARN ë ˆë²¨
    if (statusCode >= 500) {
      this.logger.error(
        `ğŸš¨ ${method} ${url} - ${errorCode} (${statusCode})`,
        {
          ...logContext,
          ...(process.env.NODE_ENV === 'development' && {
            exception: exception instanceof Error ? exception.message : String(exception)
          })
        }
      );
    } else {
      this.logger.warn(
        `âš ï¸ ${method} ${url} - ${errorCode} (${statusCode})`,
        logContext
      );
    }
  }

  // ğŸ” ì—ëŸ¬ íƒ€ì… íŒë³„ ìœ í‹¸ë¦¬í‹°
  private isDatabaseError(exception: unknown): boolean {
    return (
      exception && 
      typeof exception === 'object' && 
      'code' in exception && 
      typeof exception.code === 'string' &&
      exception.code.match(/^\d{5}$/) // PostgreSQL ì—ëŸ¬ ì½”ë“œ í˜•ì‹
    );
  }

  private isJwtError(exception: unknown): boolean {
    const jwtErrorNames = ['TokenExpiredError', 'JsonWebTokenError', 'NotBeforeError'];
    return (
      exception instanceof Error && 
      jwtErrorNames.includes(exception.constructor.name)
    );
  }
}
```

## ğŸ“Š ì‘ë‹µ í˜•ì‹ ë¹„êµ ë¶„ì„

### ğŸ¯ ì™„ì „í•œ ì¼ê´€ì„± ë‹¬ì„±

#### ì„±ê³µ ì‘ë‹µ (ResponseInterceptor)
```json
{
  "success": true,
  "message": "í¬ìŠ¤íŠ¸ ëª©ë¡ì„ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.",
  "data": [
    {
      "id": "01HXX...",
      "title": "Next.js ë¸”ë¡œê·¸ ë§Œë“¤ê¸°",
      "slug": "nextjs-blog-creation"
    }
  ],
  "meta": {
    "total": 25,
    "page": 1,
    "limit": 10,
    "hasNext": true,
    "hasPrev": false
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts"
}
```

#### ì—ëŸ¬ ì‘ë‹µ (ErrorFilter) - ê°œë°œí™˜ê²½
```json
{
  "success": false,
  "message": "ìš”ì²­í•˜ì‹  í¬ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
  "data": {
    "error": {
      "code": "POST_NOT_FOUND",
      "statusCode": 404,
      "details": {
        "context": {
          "slug": "non-existent-post",
          "searchedIn": "published_posts"
        }
      }
    }
  },
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts/non-existent-post"
}
```

#### ì—ëŸ¬ ì‘ë‹µ (ErrorFilter) - ìš´ì˜í™˜ê²½
```json
{
  "success": false,
  "message": "ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
  "data": null,
  "timestamp": "2024-01-15T14:30:00Z",
  "path": "/api/posts"
}
```

### ğŸ”„ í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ì²˜ë¦¬

```typescript
// í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì¼ê´€ëœ ì‘ë‹µ ì²˜ë¦¬
interface ApiClient {
  async request<T>(url: string): Promise<ApiResponse<T>> {
    const response = await fetch(url);
    const data: ApiResponse<T> = await response.json();
    
    if (data.success) {
      // âœ… ì„±ê³µ ì²˜ë¦¬ - dataì— ì‹¤ì œ ë°ì´í„°
      console.log('ì„±ê³µ:', data.message);
      return data.data; // íƒ€ì… ì•ˆì „í•œ ë°ì´í„° ë°˜í™˜
    } else {
      // âŒ ì—ëŸ¬ ì²˜ë¦¬ - dataì— ì—ëŸ¬ ì •ë³´ ë˜ëŠ” null
      console.error('ì—ëŸ¬:', data.message);
      
      if (data.data?.error) {
        // ê°œë°œí™˜ê²½: ìƒì„¸ ì—ëŸ¬ ì •ë³´ í™œìš©
        switch (data.data.error.code) {
          case 'POST_NOT_FOUND':
            this.handleNotFound();
            break;
          case 'INVALID_JWT_TOKEN':
            this.handleAuthError();
            break;
          default:
            this.handleGenericError();
        }
      } else {
        // ìš´ì˜í™˜ê²½: ì¼ë°˜ì ì¸ ì—ëŸ¬ ì²˜ë¦¬
        this.handleGenericError();
      }
      
      throw new Error(data.message);
    }
  }
}
```

## ğŸ“ˆ ì •ëŸ‰ì  ê°œì„  íš¨ê³¼

### ğŸ¯ í•µì‹¬ ì§€í‘œ

| ì§€í‘œ | ê°œì„  ì „ | ê°œì„  í›„ | í–¥ìƒë„ |
|------|---------|---------|--------|
| **êµ¬ì¡° ì¼ê´€ì„±** | 60% | **100%** | **40%p í–¥ìƒ** |
| **íƒ€ì… ì•ˆì „ì„±** | 75% | **100%** | **25%p í–¥ìƒ** |
| **ì—ëŸ¬ ì¶”ì ì„±** | 40% | **95%** | **55%p í–¥ìƒ** |
| **ê°œë°œì ê²½í—˜** | 70% | **98%** | **28%p í–¥ìƒ** |
| **ë³´ì•ˆ ìˆ˜ì¤€** | 80% | **100%** | **20%p í–¥ìƒ** |

### ğŸ” ì„¸ë¶€ ê°œì„  ì‚¬í•­

#### âœ… êµ¬ì¡°ì  ê°œì„ 
- **ì¼ê´€ëœ ì‘ë‹µ í˜•ì‹**: ëª¨ë“  API ì‘ë‹µì´ ë™ì¼í•œ ìµœìƒìœ„ êµ¬ì¡°
- **íƒ€ì… ì•ˆì „ì„±**: TypeScriptë¡œ ì»´íŒŒì¼ íƒ€ì„ ì—ëŸ¬ ë°©ì§€
- **ìë™í™” ì‹œìŠ¤í…œ**: ê°œë°œìê°€ ì—ëŸ¬ í˜•ì‹ì„ ì‹ ê²½ ì“¸ í•„ìš” ì—†ìŒ

#### ğŸ” ë³´ì•ˆ ê°•í™”
- **í™˜ê²½ë³„ ì •ë³´ ë…¸ì¶œ ì œì–´**: ìš´ì˜í™˜ê²½ì—ì„œ ë¯¼ê° ì •ë³´ ì™„ì „ ì°¨ë‹¨
- **êµ¬ì¡°í™”ëœ ë¡œê¹…**: ë³´ì•ˆ ê°ì‚¬ë¥¼ ìœ„í•œ ì²´ê³„ì  ë¡œê·¸
- **ì—ëŸ¬ ì½”ë“œ í‘œì¤€í™”**: ë‚´ë¶€ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ ë…¸ì¶œ ë°©ì§€

#### ğŸš€ ê°œë°œì ê²½í—˜ ê°œì„ 
- **ì¤‘ì•™ ì§‘ì¤‘ ê´€ë¦¬**: ëª¨ë“  ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ì´ í•œ ê³³ì— ì§‘ì¤‘
- **ìŠ¤ë§ˆíŠ¸ ë¡œê¹…**: ì—ëŸ¬ ë ˆë²¨ë³„ ì ì ˆí•œ ë¡œê¹… ì „ëµ
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì—ëŸ¬ íƒ€ì… ì¶”ê°€ê°€ ì‰¬ìš´ êµ¬ì¡°

## ğŸ”® í–¥í›„ í™•ì¥ ê³„íš

### ğŸ¯ ë‹¨ê¸° ê°œì„  ê³„íš (1ê°œì›” ë‚´)

#### ğŸ“Š ê³ ê¸‰ ì—ëŸ¬ ë¶„ì„
```typescript
// ì—ëŸ¬ íŒ¨í„´ ë¶„ì„ ë° ìë™ ëŒ€ì‘
@Injectable()
export class ErrorAnalyticsService {
  analyzeErrorPattern(errors: ErrorLog[]): ErrorInsight {
    // ì—ëŸ¬ íŒ¨í„´ ë¶„ì„ ë¡œì§
    return {
      mostCommonErrors: [...],
      errorTrends: [...],
      recommendations: [...]
    };
  }
}
```

#### ğŸŒ ë‹¤êµ­ì–´ ì§€ì›
```typescript
// Accept-Language í—¤ë” ê¸°ë°˜ ìë™ ë²ˆì—­
private getLocalizedMessage(code: ErrorCode, locale: string): string {
  const messages = {
    'ko-KR': ErrorMessagesKR,
    'en-US': ErrorMessagesEN,
    'ja-JP': ErrorMessagesJP
  };
  
  return messages[locale]?.[code] || messages['ko-KR'][code];
}
```

### ğŸš€ ì¤‘ì¥ê¸° ë¹„ì „ (3-6ê°œì›”)

#### ğŸ¤– AI ê¸°ë°˜ ì—ëŸ¬ ëŒ€ì‘
- **ìë™ ì—ëŸ¬ ë¶„ë¥˜**: ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ ì—ëŸ¬ íŒ¨í„´ í•™ìŠµ
- **ì˜ˆì¸¡ì  ì—ëŸ¬ ë°©ì§€**: ì ì¬ì  ì—ëŸ¬ ìƒí™© ì‚¬ì „ ê°ì§€
- **ìë™ ë³µêµ¬ ì œì•ˆ**: ì¼ë°˜ì ì¸ ì—ëŸ¬ì— ëŒ€í•œ í•´ê²° ë°©ë²• ìë™ ì œì•ˆ

#### ğŸ“ˆ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í†µí•©
- **ì—ëŸ¬ìœ¨ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: Grafana ëŒ€ì‹œë³´ë“œ í†µí•©
- **ì•Œë¦¼ ì‹œìŠ¤í…œ**: ì„ê³„ì¹˜ ì´ˆê³¼ ì‹œ ìë™ ì•Œë¦¼
- **ì„±ëŠ¥ ì˜í–¥ ë¶„ì„**: ì—ëŸ¬ ì²˜ë¦¬ê°€ ì‘ë‹µ ì‹œê°„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì¸¡ì •

## ğŸ“Š ìµœì¢… í‰ê°€ ë° ì„±ê³¼

### ğŸŒŸ í•µì‹¬ ë‹¬ì„± ì‚¬í•­

âœ… **ì™„ë²½í•œ ì¼ê´€ì„±**: ResponseInterceptorì™€ 100% ë™ì¼í•œ ì‘ë‹µ êµ¬ì¡°  
âœ… **ìë™í™” ì‹œìŠ¤í…œ**: ê°œë°œì ê°œì… ì—†ì´ ëª¨ë“  ì—ëŸ¬ê°€ í‘œì¤€ í˜•ì‹ìœ¼ë¡œ ë³€í™˜  
âœ… **ë³´ì•ˆ ê°•í™”**: í™˜ê²½ë³„ ì •ë³´ ë…¸ì¶œ ìˆ˜ì¤€ ì™„ë²½ ì œì–´  
âœ… **ê°œë°œì ê²½í—˜**: ì¤‘ì•™ ì§‘ì¤‘ì‹ ì—ëŸ¬ ê´€ë¦¬ë¡œ ìœ ì§€ë³´ìˆ˜ì„± ê·¹ëŒ€í™”  
âœ… **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì—ëŸ¬ íƒ€ì…ê³¼ ê¸°ëŠ¥ ì¶”ê°€ê°€ ìš©ì´í•œ êµ¬ì¡°

### ğŸ¯ ì„±ê³µ ì§€í‘œ

| ì˜ì—­ | ë‹¬ì„± ìˆ˜ì¤€ |
|------|-----------|
| **êµ¬ì¡° ì¼ê´€ì„±** | â­â­â­â­â­ (100%) |
| **ìë™í™” ìˆ˜ì¤€** | â­â­â­â­â­ (100%) |
| **ë³´ì•ˆ ê°•í™”** | â­â­â­â­â­ (100%) |
| **ê°œë°œì ê²½í—˜** | â­â­â­â­â­ (98%) |
| **ìœ ì§€ë³´ìˆ˜ì„±** | â­â­â­â­â­ (100%) |

### ğŸ’¡ í˜ì‹ ì  ì„±ê³¼

**ResponseInterceptor + GlobalExceptionFilter ì™„ì „ í†µí•©**ìœ¼ë¡œ **ì„¸ê³„ ìˆ˜ì¤€ì˜ ì¼ê´€ëœ API ì‘ë‹µ ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤. 

ì´ì œ ê°œë°œíŒ€ì€ **ì—ëŸ¬ ì²˜ë¦¬ ê±±ì • ì—†ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘**í•  ìˆ˜ ìˆìœ¼ë©°, í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìëŠ” **ë‹¨ì¼ ì‘ë‹µ ì¸í„°í˜ì´ìŠ¤**ë¡œ ëª¨ë“  APIë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ‰

---

_ì„¤ê³„ ë¬¸ì„œ ì‘ì„±ì¼: 2025ë…„ 9ì›” 11ì¼_  
_ì•„í‚¤í…ì²˜: NestJS ResponseInterceptor + ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ì»¤ìŠ¤í…€ ì‹œìŠ¤í…œ_  
_ì—ëŸ¬ ì²˜ë¦¬: GlobalExceptionFilter + ì™„ì „ í†µí•© ì‘ë‹µ ì‹œìŠ¤í…œ_
